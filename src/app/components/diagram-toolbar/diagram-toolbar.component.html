<div class="toolbar" [class.collapsed]="isCollapsed" [style.width.px]="isCollapsed ? 50 : sidebarWidth">
  <div class="toolbar-header">
    <button (click)="toggleSidebar()" class="sidebar-toggle" [title]="isCollapsed ? 'Expand Sidebar' : 'Collapse Sidebar'">
      {{ isCollapsed ? 'â–¶' : 'â—€' }}
    </button>
  </div>

  <div class="toolbar-content" [class.collapsed]="isCollapsed">
    <div class="toolbar-section">
      <h3>Diagram Actions</h3>
      <div class="action-buttons">
        <button (click)="newDiagram()" class="btn action-btn" title="New Diagram">ğŸ†•</button>
        <button (click)="saveDiagram()" class="btn action-btn" title="Save Diagram">ğŸ’¾</button>
        <input
          type="file"
          accept=".json"
          (change)="loadDiagram($event)"
          style="display: none"
          #fileInput>
        <button (click)="fileInput.click()" class="btn action-btn" title="Load Diagram">ğŸ“</button>
        <button (click)="addNewNode()" class="btn btn-primary action-btn" title="Add Node">â•</button>
        <button (click)="addNewBoundingBox()" class="btn action-btn" title="Add Bounding Box">â–­</button>
      </div>
    </div>

  <div class="toolbar-section" *ngIf="canGoBack">
    <h3>Navigation</h3>
    <button (click)="goBack()" class="btn btn-back">â† Back</button>
  </div>

  <div class="toolbar-section" *ngIf="selectedNodeId">
    <h3>Node Actions</h3>
    <button (click)="addIncomingTendril()" class="btn btn-tendril">+ Incoming Tendril</button>
    <button (click)="addOutgoingTendril()" class="btn btn-tendril">+ Outgoing Tendril</button>
    <button (click)="deleteSelectedNode()" class="btn btn-danger">ğŸ—‘ï¸ Delete Node</button>

    <div class="name-control">
      <label>Node Name:</label>
      <input
        type="text"
        [value]="getSelectedNodeName()"
        (input)="updateNodeName($event)"
        placeholder="Enter node name..."
        class="name-input">
    </div>

    <div class="shape-control">
      <label>Shape:</label>
      <div class="shape-buttons">
        <button
          (click)="setNodeShape('rectangle')"
          [class.active]="getSelectedNodeShape() === 'rectangle'"
          class="shape-btn"
          title="Rectangle">
          â–­
        </button>
        <button
          (click)="setNodeShape('circle')"
          [class.active]="getSelectedNodeShape() === 'circle'"
          class="shape-btn"
          title="Circle">
          â—‹
        </button>
        <button
          (click)="setNodeShape('pill')"
          [class.active]="getSelectedNodeShape() === 'pill'"
          class="shape-btn"
          title="Pill">
          â–¬
        </button>
        <button
          (click)="setNodeShape('cylinder')"
          [class.active]="getSelectedNodeShape() === 'cylinder'"
          class="shape-btn"
          title="Cylinder">
          â§ˆ
        </button>
      </div>
    </div>

    <div class="color-controls">
      <label>Fill Color:</label>
      <input
        type="color"
        [value]="getSelectedNodeFillColor()"
        (change)="updateNodeFillColor($event)"
        class="color-input">

      <label>Border Color:</label>
      <input
        type="color"
        [value]="getSelectedNodeBorderColor()"
        (change)="updateNodeBorderColor($event)"
        class="color-input">
    </div>

    <div class="accordion-section">
      <button
        type="button"
        class="accordion-header"
        (click)="notesExpanded = !notesExpanded"
        [class.expanded]="notesExpanded">
        <span class="accordion-icon">{{ notesExpanded ? 'â–¼' : 'â–¶' }}</span>
        <span class="accordion-title">Notes</span>
      </button>
      <div class="accordion-content" [class.expanded]="notesExpanded">
        <div class="notes-control">
          <textarea
            [value]="getSelectedNodeNotes()"
            (input)="updateNodeNotes($event)"
            placeholder="Enter notes for this node..."
            class="notes-textarea"
            rows="4">
          </textarea>
        </div>
      </div>
    </div>
  </div>

  <div class="toolbar-section" *ngIf="selectedBoundingBoxId">
    <h3>Bounding Box Actions</h3>
    <div class="name-control">
      <label>Label:</label>
      <input
        type="text"
        [value]="getSelectedBoundingBoxLabel()"
        (input)="updateBoundingBoxLabel($event)"
        placeholder="Enter box label..."
        class="name-input">
    </div>

    <div class="color-controls">
      <label>Fill Color:</label>
      <input
        type="color"
        [value]="getSelectedBoundingBoxFillColor()"
        (change)="updateBoundingBoxFillColor($event)"
        class="color-input">

      <label>Border Color:</label>
      <input
        type="color"
        [value]="getSelectedBoundingBoxBorderColor()"
        (change)="updateBoundingBoxBorderColor($event)"
        class="color-input">
    </div>

    <button (click)="deleteSelectedBoundingBox()" class="btn btn-danger" style="margin-top: 15px;">ğŸ—‘ï¸ Delete Bounding Box</button>
  </div>

  <div class="toolbar-section" *ngIf="selectedTendrilId">
    <h3>Tendril Actions</h3>
    <div class="name-control">
      <label>{{ getSelectedTendrilTypeLabel() }}:</label>
      <input
        type="text"
        [value]="getSelectedTendrilName()"
        (input)="updateTendrilName($event)"
        placeholder="Enter tendril name..."
        class="name-input">
    </div>

    <div class="exposure-control">
      <label>Visibility:</label>
      <div class="radio-group">
        <label class="radio-label">
          <input
            type="radio"
            [checked]="getSelectedTendrilExposed()"
            (change)="setTendrilExposed(true)"
            name="tendril-exposure">
          Exposed
        </label>
        <label class="radio-label">
          <input
            type="radio"
            [checked]="!getSelectedTendrilExposed()"
            (change)="setTendrilExposed(false)"
            name="tendril-exposure">
          Internal
        </label>
      </div>
    </div>

    <button (click)="deleteSelectedTendril()" class="btn btn-danger" style="margin-top: 15px;">ğŸ—‘ï¸ Delete Tendril</button>
  </div>

  <div class="toolbar-section" *ngIf="selectedEdgeId">
    <h3>Edge Actions</h3>
    <div class="name-control">
      <label>Edge Name:</label>
      <input
        type="text"
        [value]="getSelectedEdgeName()"
        (input)="updateEdgeName($event)"
        placeholder="Enter edge name..."
        class="name-input">
    </div>

    <button (click)="deleteSelectedEdge()" class="btn btn-danger" style="margin-top: 15px;">ğŸ—‘ï¸ Delete Edge</button>
  </div>

  <div class="toolbar-section">
    <div class="accordion-section">
      <button
        type="button"
        class="accordion-header"
        (click)="instructionsExpanded = !instructionsExpanded"
        [class.expanded]="instructionsExpanded">
        <span class="accordion-icon">{{ instructionsExpanded ? 'â–¼' : 'â–¶' }}</span>
        <span class="accordion-title">Instructions</span>
      </button>
      <div class="accordion-content" [class.expanded]="instructionsExpanded">
        <ul class="instructions">
          <li>Use "New Node" button to add nodes</li>
          <li>Drag nodes to reposition</li>
          <li>Drag blue circle on selected nodes to resize</li>
          <li>Right-click nodes to rename, customize colors & add notes</li>
          <li>Right-click tendrils to rename them</li>
          <li>Double-click nodes to enter inner diagrams</li>
          <li>Click orange tendrils to start edges, green tendrils to complete</li>
          <li>Right-click to cancel edge creation</li>
          <li>Right-click nodes/tendrils to select, then delete</li>
          <li>Press Delete key to remove selected items</li>
        </ul>
      </div>
    </div>
  </div>
  </div>
</div>
